/*History Functions*/function setHashState(e,t,n){window.location.href="#book="+e+"&chapter="+t+"&verse="+n}function previousChapter(){if($("select#chapterSelect option:selected").prev().attr("selected","selected").change().length>0)return!0}function previousBook(){$("select#bookSelect option:selected").prev().attr("selected","selected").change();return!0}function selectOptionDisplay(e){var t=new Date,n=!1;$(".current").removeClass("current");if(e.hasClass("bookSelect"))var r=e.val(),i=1,s=1;else if(e.hasClass("chapterSelect"))var r=$("select#bookSelect").val(),i=e.val(),s=1;else if(e.hasClass("verseSelect"))var r=$("select#bookSelect").val(),i=$("select#chapterSelect").val(),s=e.val();else var r=$("select#bookSelect").val(),i=$("select#chapterSelect").val(),s=$("select#verseSelect").val();setHashState(r,i,s);var o=new Date;timer(t,o)}function subdueColor(e,t){return parseInt(e/t)}function getStrongsColor(e){var t=.045,n=e*t;return"hsl( "+n+", 50%, 50% )"}function getStrongsStyle(e,t){return"."+e+" {color:#fff;background:"+t+" !important;}"}function searchByStrongsNumber(e){var t=new Date,n="",r=new Array,i=$("#searchSelect").val(),s="",o=e.replace(/ /gi,"");highlightStrongsNumber(e);r=e.split(" ");n+='<form><ol class="references">';var u=0,a=bibleObject;if($("select[name=searchLanguage]").val()==="hebrew"){a=hebrewObject;$.each(r,function(e,t){parseFloat(t.substring(1,t.length))>0&&(r[e]=t.substring(2,t.length))})}var f=new Array;$.each(a,function(e,t){$("#searchRange").val()==="book"?findArrayElementsInString(r,t,i)&&f.push([e,1,1,u]):$.each(t,function(t,n){$("#searchRange").val()==="chapter"?findArrayElementsInString(r,n,i)&&f.push([e,t+1,1,u]):$.each(n,function(n,s){findArrayElementsInString(r,s,i)&&f.push([e,t+1,n+1,u])})})});n+=createReferenceList(f);n+="</ol></form>";$("#referenceTracking .collapsable").addClass("closed");$("#referenceTracking #"+o).removeClass("closed");!$("#referenceTracking #"+o+" form").length>0&&$("#referenceTracking #"+o).append(n);goToFirstReference();var l=new Date;timer(t,l)}function createWordString(e,t){var n="",r="";n+="<span";n+=' class="'+e.lemma+'"';n+=' title="'+e.lemma;e.hasOwnProperty("morph")&&(n+=" "+e.morph);n+='"';n+=' data-word="'+e.word+'"';n+=' data-lemma="'+e.lemma+'"';n+=' data-language="'+t+'"';n+=' data-range="verse"';n+=' data-family="'+r+'"';e.hasOwnProperty("morph")&&(n+=' data-morph="'+e.morph+'"');n+=">"+e.word+"</span> ";return n}function initializeWordPanel(e){if(!e.data("lemma"))return!1;var t=e.data("lemma").split(" "),n="",r="",i="",s="",o="",u="";$(".control-panel .duplicated").remove();$.each(t,function(t,n){if(n!=="added"&&n!=="trans-change"){r=n;osidStrongsNumber=n;i=stripPointing(strongsDictionary[osidStrongsNumber].lemma);s=strongsDictionary[osidStrongsNumber].strongs_def;o=strongsDictionary[osidStrongsNumber].kjv_def;u=e.text();var a=$(".control-panel .template").clone().removeClass("template").addClass("duplicated");a.appendTo("#wordControlPanel .control-panel");a.find(".wordControlPanelStrongsNumber").addClass(r).text(r);a.find(".wordControlPanelLemma").text(i);a.find(".wordControlPanelEnglish").text(u);a.find(".wordControlPanelStrongsDef").text(s);a.find(".wordControlPanelKJVDef").text(o)}var f="";typeof strongsObject[n]!="undefined"&&$.each(strongsObject[n],function(e,t){f+='<a href="#search='+t+'" class="'+t+'">'+t+"</a><br />"});var l="";$.each(strongsObject,function(e,t){$.each(t,function(t,r){r==n&&(l+='<a href="#search='+e+'" class="'+e+'">'+e+"</a><br />")})});wordTreeString="";f==""?wordTreeString+="<p>no roots</p>":wordTreeString+="roots:<br />"+f+"</p>";l==""?wordTreeString+="<p>no branches</p>":wordTreeString+="branches:<br />"+l+"</p>";a.find("#wordTree").html(wordTreeString);var c=parseInt(n.substring(1,n.length),10);console.log(c);var h=getStrongsColor(c);strongsStyle=getStrongsStyle(n,h);$("#wordControlPanel").find("style").html(strongsStyle)})}function showWordPanel(e){$("#wordControlPanel").show();var t="",n=e.offset().top+e.height();if(n+$("#wordControlPanel").height()>$("body").height()){var n=e.offset().top-$("#wordControlPanel").height();t+="bottom"}else t+="top";var r=e.offset().left+e.width();t+=" ";if(r+$("#wordControlPanel").width()>$("body").width()){var r=e.offset().left-$("#wordControlPanel").width();t+="right"}else t+="left";$("#wordControlPanel").css({top:n,left:r}).attr("class","").addClass("not-active").addClass(t);$("#wordControlPanel .definitions").addClass("hide")}function hideWordPanel(){}function wordTree(e){$("#wordTree").html("Loading");var t="";typeof strongsObject[e]!="undefined"&&$.each(strongsObject[e],function(e,n){t+='<a href="#search='+n+'" class="'+n+'">'+n+"</a><br />"});var n="";$.each(strongsObject,function(t,r){$.each(r,function(r,i){i==e&&(n+='<a href="#search='+t+'" class="'+t+'">'+t+"</a><br />")})});wordTreeString="";t==""?wordTreeString+="<p>no roots</p>":wordTreeString+="roots:<br />"+t+"</p>";n==""?wordTreeString+="<p>no branches</p>":wordTreeString+="branches:<br />"+n+"</p>";$("#wordTree").html(wordTreeString)}function goToReference(e,t,n){$("select#bookSelect").val(e);$("select#chapterSelect").val(t);$("select#verseSelect").val(n).change()}function maintainState(e,t,n){$(".dynamic").each(function(){if($(this).hasClass("chapterSelect"))var n=bibleObject[e].length;else if($(this).hasClass("verseSelect"))var r=t-1,n=bibleObject[e][r].length;$(this).attr("size")>0&&$(this).attr("size",n);var i="",s=0;while(s<n){s+=1;i+="<option>"+s+"</option>"}$(this).html(i)});$("select.bookSelect").val(e);$("select.chapterSelect").val(t);$("select.verseSelect").val(n)}function goToFirstReference(){$(".references ol li:first").attr("id","currentRef").find("a").click()}function markReference(e){$(".references #currentRef").attr("id","");e.attr("id","currentRef");var t=e.attr("id","currentRef").find("a").attr("href");window.location.hash=t}function timer(e,t){var n=e.getTime(),r=t.getTime();typeof console!="undefined"&&console.log(r-n)}function createColorCode(e,t,n){return"rgb("+e+","+t+","+n+")"}function stripPointing(e){var t=e.replace(/֑/gi,"").replace(/֓/gi,"").replace(/֕/gi,"").replace(/֖/gi,"").replace(/֘/gi,"").replace(/֙/gi,"").replace(/֚/gi,"").replace(/֛/gi,"").replace(/֜/gi,"").replace(/֝/gi,"").replace(/֞/gi,"").replace(/֟/gi,"").replace(/֠/gi,"").replace(/֡/gi,"").replace(/֢/gi,"").replace(/֣/gi,"").replace(/֤/gi,"").replace(/֥/gi,"").replace(/֦/gi,"").replace(/֧/gi,"").replace(/֩/gi,"").replace(/֪/gi,"").replace(/֫/gi,"").replace(/֬/gi,"").replace(/֭/gi,"").replace(/֮/gi,"").replace(/֯/gi,"").replace(/ֱ/gi,"").replace(/ֲ/gi,"").replace(/ֳ/gi,"").replace(/ֵ/gi,"").replace(/ֶ/gi,"").replace(/ַ/gi,"").replace(/ָ/gi,"").replace(/ֹ/gi,"").replace(/ֺ/gi,"").replace(/ֻ/gi,"").replace(/ּ/gi,"").replace(/ֽ/gi,"").replace(/־/gi,"").replace(/׀/gi,"").replace(/ׂ/gi,"").replace(/׃/gi,"").replace(/ׄ/gi,"").replace(/ׇ/gi,"").replace(/ׁ/gi,"").replace(/ִ/gi,"").replace(/ְ/,"").replace(/ְ/,"").replace(/ְ/,"").replace(/ְ/,"").replace(/֗/,"").replace(/ְ/,"").replace(/ְ/,"").replace(/֔/,"").replace(/ְ/,"").replace(/ְ/,"").replace(/֨/,"").replace(/֑/,"").replace(/֗/,"").replace(/֨/,"").replace(/֔/,"");return t}function findRareWords(e){loading($("#rareWords"));setTimeout(function(){var t="rare words: <ol>",n=0;$.each(createUniqueStrongsNumbersArray(),function(r,i){var s=0;$.each(bibleObject,function(t,n){s<e&&$.each(n,function(e,t){$.each(t,function(e,t){t.toLowerCase().indexOf(i.toLowerCase())>0&&(s+=1)})})});if(s<e){t+='<li><a href="#search='+i+'" class="'+i+'">'+i+"</a>: "+s+"</li>";highlightStrongsNumber(i)}n+=1});t+="</ol>";n==0&&(t="none");$("#rareWords").html(t)},1)}function loading(e){e.html("loading")}function createUniqueStrongsNumbersArray(){var e=new Array;$.each($("#verse ol li span"),function(t){var n=$(this).attr("class").split(" ");$.each(n,function(t,n){e.push(n)})});return e.unique()}function createReferenceListItem(e){var t=e[0],n=e[1],r=e[2],i=e[3];return'<li><a href="#book='+t+"&chapter="+n+"&verse="+r+'">'+t+" "+n+":"+r+'</a><input type="hidden" value="'+i+'" /></li>'}function currentReference(){var e=new Array;e[0]=$("select.bookSelect").val();e[1]=$("select.chapterSelect").val();e[2]=$("select.verseSelect").val();return e}function toHex(e){if(e==null)return"00";e=parseInt(e);if(e==0||isNaN(e))return"00";e=Math.max(0,e);e=Math.min(e,255);e=Math.round(e);return"0123456789ABCDEF".charAt((e-e%16)/16)+"0123456789ABCDEF".charAt(e%16)}function RGBtoHEX(e){if(e.substring(0,3)=="rgb"){var t=e.split(","),n=t[0].replace("rgb(","").trim(),r=t[1].trim(),i=t[2].replace(")","").trim(),s=[toHex(n),toHex(r),toHex(i)];return"#"+s.join("")}return e}var findArrayElementsInString=function(e,t,n){var r=0;t=t.toString();$.each(e,function(e,n){if(parseFloat(n.substring(1,n.length))>0)var i=!0;var s=t.toLowerCase().indexOf(n.toLowerCase());if(s>0){var o=s+n.length,u=t.substring(o,o+1),a=s-1,f=t.substring(a,a+1);i?parseInt(u).toString()==="NaN"&&r++:$("#strictSearch:checked").length>0?(u===" "||u==="<")&&(f===" "||f==="<")&&r++:r++}});return r>0&&n==="any"||r>e.length-1&&n==="all"?!0:!1},hoverIntentConfig={sensitivity:1,interval:250,over:function(){initializeWordPanel($(this))},timeout:250,out:function(){hideWordPanel()}},createReferenceList=function(e){var t="";$.each(e,function(e,n){t+=createReferenceListItem(n)});return t};Array.prototype.unique=function(){var e=[],t=this.length;for(var n=0;n<t;n++){for(var r=n+1;r<t;r++)this[n]===this[r]&&(r=++n);e.push(this[n])}return e};